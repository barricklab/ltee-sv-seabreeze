This is a tutorial with example data for _seabreeze_. Please [install the software, create the conda enviroment and activate it](installation.md ) first. 

To get started, navigate to the root of the _seabreeze_ directory, and copy the `example/` directory:
```
cp -r example/ data/
```

The newly created `data/` folder should look like this:
```
|---data/
|   |
|   |---data.csv
|   |---ori_dif_sequences.csv
|   |---02_genomes/
|   |   |
|   |   |---REL606_evolved_1.fasta
|   |   |---REL606_evolved_2.fasta
|   |   |---REL606.fasta
```

For this tutorial, structural variant mutations have been simulated on the *E. coli* strain REL606 genome using _breseq_. These mutated genome assemblies are `REL606_evolved_1.fasta` and `REL606_evolved_2.fasta`. We aim to identify the structural variants in these assemblies relative to their ancestor, `REL606.fasta`. These pairwise comparisons to be performed are specified in a csv file called `data.csv` in the `data/` directory.  For more information about the valid format of this file, please see the [usage](usage.md) page.

To view this csv file:
```
cat data/data.csv
```

It should look like this:

| assembly         | ancestor |     |
| ---------------- | -------- | --- |
| REL606           | REL606   |     |
| REL606_evolved_1 | REL606   |     |
| REL606_evolved_2 | REL606   |     |

We include a comparison of `REL606` to itself as a quality check step, as we do not expect any mutations when a genome is compared to itself.

All of the following commands should be run from the _seabreeze_ root directory. Here, 4 cores have been allocated to run _seabreeze_ but this number can be higher on lower depending on your hardware.
## Compute size difference between genomes

This command compares the sizes of the assemblies to their specified ancestors in a pairwise manner. 

```
snakemake --use-conda --cores 4 analyse_genome_sizes
```

The output file generated is `data/04_rename_genome/genome_size_stats.csv`. Please see [Output](output.md) for more information about the fields in this table. This table should look this this:

| assembly         | ancestor | size_assembly | size_ancestor | difference | percent_change |
| ---------------- | -------- | ------------- | ------------- | ---------- | -------------- |
| REL606           | REL606   | 4629812       | 4629812       | 0          | 0.0            |
| REL606_evolved_1 | REL606   | 4617111       | 4629812       | -12701     | -0.2743        |
| REL606_evolved_2 | REL606   | 4549910       | 4629812       | -79902     | -1.7258        |

As we expected, there is no size difference when `REL606` is compared to itself. We can see that both of the assemblies `REL606_evolved_1` and `REL606_evolved_2` are smaller than the ancestor.

## Predict the location of insertion sequences

This command uses [ISEscan](https://github.com/xiezhq/ISEScan/blob/master/README.md?plain=1) to annotate partial and full-length IS elements in the genomes. 
```
snakemake --use-conda --cores 4 predict_IS_elements
```

All of the output generated is stored in `data/05_isescan_tables/`. This tutorial should generate the following files in this directory:

```
|---05_isescan_tables/
|   |
|   |---REL606.csv
|   |---REL606_evolved_1.csv
|   |---REL606_evolved_2.csv
|   |---REL606/
|   |---REL606_evolved_1/
|   |---REL606_evolved_2/
```
Each assembly has a .csv file that describes the locations of IS elements in that genome, and a directory where the additionally files generated by _ISEScan_ are made. For information about interpreting this csv file, we refer users to the official [ISEScan documentation](https://github.com/xiezhq/ISEScan/blob/master/README.md).


